<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Elijah Knaap">
<meta name="dcterms.date" content="2025-07-25">

<title>Spatial: Networks, Interaction, &amp; Econometrics for Migration</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./notebooks/01_spatial_graphs.html" rel="next">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-8ca220f91a885683af94e7682fba50ef.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-e24a41571b05293e9c3ef0d8729e90dc.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-8ca220f91a885683af94e7682fba50ef.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4835b8b410d8a4586f4a4e5b54492fbd.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-f307cd4cca12a64d2560196ce059630d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-4835b8b410d8a4586f4a4e5b54492fbd.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-0PG1JNLCXB"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-0PG1JNLCXB', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Spatial: Networks, Interaction, &amp; Econometrics for Migration">
<meta property="og:description" content="">
<meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="Spatial: Networks, Interaction, &amp; Econometrics for Migration">
<meta name="twitter:title" content="Spatial: Networks, Interaction, &amp; Econometrics for Migration">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="Spatial: Networks, Interaction, &amp;amp; Econometrics for Migration">
<meta name="citation_author" content="Elijah Knaap">
<meta name="citation_publication_date" content="2025-07-25">
<meta name="citation_cover_date" content="2025-07-25">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-07-25">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Modeling Spatial Autocorrelation in Spatial Interaction Data: An Application to Patent Citation Data in the European Union;,citation_abstract=Spatial interaction models of the gravity type are widely used to model origin–destination flows. They draw attention to three types of variables to explain variation in spatial interactions across geographic space: variables that characterize an origin region of a flow, variables that characterize a destination region of a flow, and finally variables that measure the separation between origin and destination regions. This paper outlines and compares two approaches, the spatial econometric and the eigenfunction-based spatial filtering approach, to deal with the issue of spatial autocorrelation among flow residuals. An example using patent citation data that capture knowledge flows across 112 European regions serves to illustrate the application and the comparison of the two approaches.;,citation_author=Manfred M. Fischer;,citation_author=Daniel A. Griffith;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1467-9787.2008.00572.x;,citation_issue=5;,citation_doi=10.1111/j.1467-9787.2008.00572.x;,citation_issn=1467-9787;,citation_volume=48;,citation_language=en-US;,citation_journal_title=Journal of Regional Science;">
<meta name="citation_reference" content="citation_title=A Method of Fitting the Gravity Model Based on the Poisson Distribution;,citation_author=Robin Flowerdew;,citation_author=Murray Aitkin;,citation_publication_date=1982;,citation_cover_date=1982;,citation_year=1982;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1467-9787.1982.tb00744.x;,citation_issue=2;,citation_doi=10.1111/j.1467-9787.1982.tb00744.x;,citation_issn=1467-9787;,citation_volume=22;,citation_language=en-US;,citation_journal_title=Journal of Regional Science;">
<meta name="citation_reference" content="citation_title=Spatial interaction models: Formulations and applications;,citation_author=A Stewart Fotheringham;,citation_author=Morton E O’Kelly;,citation_publication_date=1989;,citation_cover_date=1989;,citation_year=1989;">
<meta name="citation_reference" content="citation_title=Spatial Interaction and Spatial Autocorrelation: A Cross-Product Approach;,citation_abstract=A cross-product statistic is used to demonstrate that spatial interaction models are a special case of a general model of spatial autocorrelation. A series of traditional measures of spatial autocorrelation is shown to have a cross-product form. Several interaction models are shown to have a similar form. A general spatial statistic is developed which indicates that the relationship between the two types of models is particularly strong when the focus is on measurements from a single point.;,citation_author=A Getis;,citation_publication_date=1991-09;,citation_cover_date=1991-09;,citation_year=1991;,citation_fulltext_html_url=https://journals.sagepub.com/doi/10.1068/a231269;,citation_issue=9;,citation_doi=10.1068/a231269;,citation_issn=0308-518X, 1472-3409;,citation_volume=23;,citation_language=en-US;,citation_journal_title=Environment and Planning A: Economy and Space;,citation_journal_abbrev=Environ Plan A;">
<meta name="citation_reference" content="citation_title=Spatial weights matrices;,citation_abstract=The impetus for Cliff and Ord’s landmark article, &amp;amp;amp;quot;The Problem of Spatial Autocorrelation,&amp;quot; was to avoid the problem of topological invariance in the spatial weights matrix. The problem and three points of view on it - theoretical, topological, and empirical - are discussed. © 2009 The Ohio State University.;,citation_author=Arthur Getis;,citation_publication_date=2009-10;,citation_cover_date=2009-10;,citation_year=2009;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/10.1111/j.1538-4632.2009.00768.x;,citation_issue=4;,citation_doi=10.1111/j.1538-4632.2009.00768.x;,citation_issn=00167363;,citation_volume=41;,citation_journal_title=Geographical Analysis;">
<meta name="citation_reference" content="citation_title=Opportunities, race, and urban location: The influence of John Kain;,citation_author=Edward L Glaeser;,citation_author=Eric A Hanushek;,citation_author=John M Quigley;,citation_publication_date=2004-07;,citation_cover_date=2004-07;,citation_year=2004;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S0094119004000403;,citation_issue=1;,citation_doi=10.1016/j.jue.2004.03.002;,citation_issn=00941190;,citation_volume=56;,citation_language=en-US;,citation_journal_title=Journal of Urban Economics;,citation_journal_abbrev=Journal of Urban Economics;">
<meta name="citation_reference" content="citation_title=The spatial autocorrelation problem in spatial interaction modelling: A comparison of two common solutions;,citation_abstract=Spatial interaction models of the gravity type are widely used to describe origin-destination flows. They draw attention to three types of variables to explain variation in spatial interactions across geographic space: variables that characterize the origin region of interaction, variables that characterize the destination region of interaction, and variables that measure the separation between origin and destination regions. A violation of standard minimal assumptions for least squares estimation may be associated with two problems: spatial autocorrelation within the residuals, and spatial autocorrelation within explanatory variables. This paper compares a spatial econometric solution with the spatial statistical Moran eigenvector spatial filtering solution to accounting for spatial autocorrelation within model residuals. An example using patent citation data that capture knowledge flows across 257 European regions serves to illustrate the application of the two approaches.;,citation_author=Daniel A. Griffith;,citation_author=Manfred M. Fischer;,citation_author=James LeSage;,citation_publication_date=2017-03-01;,citation_cover_date=2017-03-01;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.1007/s12076-016-0172-8;,citation_issue=1;,citation_doi=10.1007/s12076-016-0172-8;,citation_issn=1864-404X;,citation_volume=10;,citation_language=en-US;,citation_journal_title=Letters in Spatial and Resource Sciences;,citation_journal_abbrev=Lett Spat Resour Sci;">
<meta name="citation_reference" content="citation_title=Spatial interaction modeling;,citation_abstract=Spatial interaction (SI) is the process whereby entities at different points in physical space make contacts, demand/supply decisions or locational choices. The entities can be individuals or firms and the choices can include housing, jobs, production quantities, exports, imports, face-to-face contacts, schools, retail centres and activity centres. The first SI models can be grouped under the generic heading gravity models. Their main characteristic is that they model the behaviour of demand or supply segments, rather than that of individuals and firms. This article traces the development of these models from their inception in the early part of the twentieth century to the present. The key advances include the replacement of the gravity analogy by the more general concepts of entropy or information theory, a statistical framework commonly used in physics. With the arrival of the regional science paradigm over 50 years ago, a key challenge has been to broaden these models compared to those arising in spatial economics, thus arriving at a more inclusive probabilistic framework. These efforts are discussed here, as well as inclusion of geographical advances, embracing activities as generators of travel, time-geography, recognition of spatial interdependencies, and use of neuro-computing principles.;,citation_author=Daniel A. Griffith;,citation_author=Yongwan Chun;,citation_author=Bin Li;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/B9780128150436000070;,citation_doi=10.1016/B978-0-12-815043-6.00007-0;,citation_isbn=978-0-12-815043-6;,citation_inbook_title=Spatial Regression Analysis Using Eigenvector Spatial Filtering;">
<meta name="citation_reference" content="citation_title=Housing Segregation, Negro Employment, and Metropolitan Decentralization;,citation_abstract=I. Negro residential segregation, 176. — II. Segregation in Detroit and Chicago, 178. — III. The distribution of negro employment, 179. — IV. Negro employment by occupation and industry, 183. — V. The level of nonwhite employment, 189. — VI. Suburbanization and negro employment, 191. — VII. Postwar dispersal of employment and population in Chicago, 192. — VIII. Conclusions, 196.;,citation_author=John F. Kain;,citation_publication_date=1968;,citation_cover_date=1968;,citation_year=1968;,citation_issue=2;,citation_doi=10.2307/1885893;,citation_isbn=2033670007;,citation_issn=00335533;,citation_volume=82;,citation_journal_title=The Quarterly Journal of Economics;">
<meta name="citation_reference" content="citation_title=The Spatial Mismatch Hypothesis: Three Decades Later;,citation_author=John F. Kain;,citation_publication_date=1992;,citation_cover_date=1992;,citation_year=1992;,citation_issue=2;,citation_doi=10.1080/10511482.1992.9521100;,citation_volume=3;,citation_journal_title=Housing Policy Debate;,citation_publisher=Taylor &amp;amp;amp; Francis;">
<meta name="citation_reference" content="citation_title=Knowledge spillovers across Europe: Evidence from a Poisson spatial interaction model with spatial effects;,citation_abstract=Abstract. We apply a Bayesian hierarchical Poisson spatial interaction model to the paper trail left by patent citations between high-technology patents in Europe to identify and measure spatial separation effects of interregional knowledge flows. The model introduced here is novel in that it allows for spatially structured origin and destination effects for the regions. Estimation of the model is carried out within a Bayesian framework using data augmentation and Markov Chain Monte Carlo (MCMC) methods, related to recent work in Frühwirth-Schnatter and Wagner (2004). This allows MCMC sampling from well-known distribution families, and thus provides a substantial improvement over MCMC estimation based on Metropolis-Hastings sampling from non-standard conditional distributions. Abstract. Hemos aplicado un modelo de interacción espacial de Poisson Bayesiano jerárquico a la siguiendo la pista a documentación que menciona otras patentes entre patentes de alta tecnología en Europa para identificar y medir efectos de separación espacial de flujos de conocimiento interregionales. El modelo aquí introducido es novedoso en cuanto a que admite efectos de origen y destino espacialmente estructurados para las regiones. La estimación del modelo se lleva a cabo bajo un marco Bayesiano usando métodos de aumento de datos y Monte Carlo basado en cadenas de Markov (MCMC), relacionado con investigación reciente de Frühwirth-Schnatter y Wagner (2004). Esto permite el muestreo MCMC de familias de distribución bien conocidas, proporcionando así una mejora substancial sobre estimaciones MCMC basadas en muestreo Metropolis-Hastings de distribuciones condicionales no estándar.;,citation_author=James P. LeSage;,citation_author=Manfred M. Fischer;,citation_author=Thomas Scherngell;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1435-5957.2007.00125.x;,citation_issue=3;,citation_doi=10.1111/j.1435-5957.2007.00125.x;,citation_issn=1435-5957;,citation_volume=86;,citation_language=en-US;,citation_journal_title=Papers in Regional Science;">
<meta name="citation_reference" content="citation_title=Incorporating Transportation Network Structure in Spatial Econometric Models of Commodity Flows;,citation_abstract=We use a spatial econometric extension of the traditional regression-based gravity model to model commodity flows, focusing on a formal methodology for incorporating information regarding the highway network into the spatial connectivity structure of the spatial autoregressive econometric model. We show that our simple approach to incorporating this information in the model produces improved model fit and higher likelihood function values. Empirical estimates of the relative importance of the different types of origin–destination connectivity between regions indicates that the strongest spatial autoregressive effects arise when both origin and destination regions have neighbouring regions located on the highway network.;,citation_author=James P. LeSage;,citation_author=Wolfgang Polasek;,citation_publication_date=2008-06-01;,citation_cover_date=2008-06-01;,citation_year=2008;,citation_fulltext_html_url=https://doi.org/10.1080/17421770801996672;,citation_issue=2;,citation_doi=10.1080/17421770801996672;,citation_issn=1742-1772;,citation_volume=3;,citation_journal_title=Spatial Economic Analysis;,citation_publisher=RSA Website;">
<meta name="citation_reference" content="citation_title=Spatial Econometric Modeling Of Origin-Destination Flows;,citation_author=James P. LeSage;,citation_author=R Kelley Pace;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_issue=5;,citation_doi=10.1111/j.1467-9787.2008.00573.x;,citation_volume=48;,citation_journal_title=Journal of Regional Science;">
<meta name="citation_reference" content="citation_title=Spatial Econometric Methods for Modeling Origin-Destination Flows;,citation_abstract=Spatial econometric theory and practice have been dominated by a focus on object data. In economic analysis these objects correspond to economic agents with discrete locations in geographic space, such as addresses, census tracts and regions. In contrast spatial interaction or flow data pertain to measurements each of which is associated with a link or pair of origin-destination locations that represent points or areas in space. While there is a voluminous literature on the specification and estimation of models for cross-sectional object data (see, Chapter C.1 in this volume), less attention has been paid to sample data consisting of origin-destination pairs that form the basic units of analysis in spatial interaction models.;,citation_author=James P. LeSage;,citation_author=Manfred M. Fischer;,citation_editor=Manfred M. Fischer;,citation_editor=Arthur Getis;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_fulltext_html_url=https://doi.org/10.1007/978-3-642-03647-7_20;,citation_doi=10.1007/978-3-642-03647-7_20;,citation_isbn=978-3-642-03647-7;,citation_language=en-US;,citation_inbook_title=Handbook of Applied Spatial Analysis: Software Tools, Methods and Applications;">
<meta name="citation_reference" content="citation_title=A spatial interaction model with spatially structured origin and destination effects;,citation_abstract=We introduce a Bayesian hierarchical regression model that extends the traditional least-squares regression model used to estimate gravity or spatial interaction relations involving origin-destination flows. Spatial interaction models attempt to explain variation in flows from n origin regions to n destination regions resulting in a sample of N&nbsp;=&nbsp;n2 observations that reflect an n by n flow matrix converted to a vector. Explanatory variables typically include origin and destination characteristics as well as distance between each region and all other regions. Our extension introduces latent spatial effects parameters structured to follow a spatial autoregressive process. Individual effects parameters are included in the model to reflect latent or unobservable influences at work that are unique to each region treated as an origin and destination. That is, we estimate 2n individual effects parameters using the sample of N&nbsp;=&nbsp;n2 observations. We illustrate the method using a sample of commodity flows between 18 Spanish regions during the 2002 period.;,citation_author=James P. LeSage;,citation_author=Carlos Llano;,citation_publication_date=2013-07-01;,citation_cover_date=2013-07-01;,citation_year=2013;,citation_fulltext_html_url=https://doi.org/10.1007/s10109-013-0181-8;,citation_issue=3;,citation_doi=10.1007/s10109-013-0181-8;,citation_issn=1435-5949;,citation_volume=15;,citation_language=en-US;,citation_journal_title=Journal of Geographical Systems;,citation_journal_abbrev=J Geogr Syst;">
<meta name="citation_reference" content="citation_title=What Regional Scientists Need to Know About Spatial Econometrics;,citation_author=James P. LeSage;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_fulltext_html_url=http://www.ssrn.com/abstract=2420725;,citation_doi=10.2139/ssrn.2420725;,citation_issn=1556-5068;,citation_language=en-US;,citation_journal_title=SSRN Electronic Journal;,citation_journal_abbrev=SSRN Journal;">
<meta name="citation_reference" content="citation_title=Spatial Regression-Based Model Specifications for Exogenous and Endogenous Spatial Interaction;,citation_abstract=Spatial interaction models represent a class of models that are used for modeling origin-destination flow data. The interest in such models is motivated by the need to understand and explain the flows of tangible entities such as persons or commodities or intangible ones such as capital, information or knowledge between regions. These models attempt to explain interaction between origin and destination regions using (i) origin-specific attributes characterizing the ability of the origins to generate flows, (ii) destination-specific characteristics representing the attractiveness of destinations, and (iii) variables that characterize the way spatial separation of origins from destinations constrains or impedes the interaction. They implicitly assume that using spatial separation variables such as distance between origin and destination regions will eradicate the spatial dependence among the sample of spatial flows.;,citation_author=James P. LeSage;,citation_author=Manfred M. Fischer;,citation_editor=Roberto Patuelli;,citation_editor=Giuseppe Arbia;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_fulltext_html_url=https://doi.org/10.1007/978-3-319-30196-9_2;,citation_doi=10.1007/978-3-319-30196-9_2;,citation_isbn=978-3-319-30196-9;,citation_language=en-US;,citation_inbook_title=Spatial Econometric Interaction Modelling;">
<meta name="citation_reference" content="citation_title=A Data‐Driven Approach to Spatial Interaction Models of Migration: Integrating and Refining the Theories of Competing Destinations and Intervening Opportunities;,citation_abstract=ABSTRACTTraditional spatial interaction (SI) models of migration are susceptible to misspecification when the spatial structure of locations is not properly incorporated. To address this, a novel SI model for migration is introduced that integrates the theories of competing destinations (CD) and intervening opportunities (IO) to capture multiscale spatial structure using the recent generalized additive spatial smoothing (GASS) framework. This GASS CDIO model can identify the appropriate spatial scales to represent the spatial structure of origins and destinations in a data‐driven manner. Validation of the model was conducted through two simulation experiments. The first demonstrates that employing the incorrect scale to capture spatial structure in SI models biases the parameter estimates and increases uncertainty. The second demonstrates that the GASS approach reliably recovers accurate parameters by identifying optimal hyperparameters associated with multiple spatial scales. The GASS CDIO model was then applied to U.S. inter‐county migration data and compared to several other model specifications. The results reveal the unique spatial structure from the perspective of origins and destinations and illustrate the improved recoverability of anticipated migration relationships. This work suggests that the GASS CDIO model better integrates spatial theories of migration and accounts for the multiscale nature of SI processes.;,citation_author=Mengyu Liao;,citation_author=Taylor M. Oshan;,citation_publication_date=2025-03-06;,citation_cover_date=2025-03-06;,citation_year=2025;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/10.1111/gean.70001;,citation_doi=10.1111/gean.70001;,citation_issn=0016-7363, 1538-4632;,citation_language=en-US;,citation_journal_title=Geographical Analysis;,citation_publisher=Wiley;">
<meta name="citation_reference" content="citation_title=Estimating log models: To transform or not to transform?;,citation_abstract=Health economists often use log models to deal with skewed outcomes, such as health utilization or health expenditures. The literature provides a number of alternative estimation approaches for log models, including ordinary least-squares on ln(y) and generalized linear models. This study examines how well the alternative estimators behave econometrically in terms of bias and precision when the data are skewed or have other common data problems (heteroscedasticity, heavy tails, etc.). No single alternative is best under all conditions examined. The paper provides a straightforward algorithm for choosing among the alternative estimators. Even if the estimators considered are consistent, there can be major losses in precision from selecting a less appropriate estimator.;,citation_author=Willard G Manning;,citation_author=John Mullahy;,citation_publication_date=2001-07-01;,citation_cover_date=2001-07-01;,citation_year=2001;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0167629601000868;,citation_issue=4;,citation_doi=10.1016/S0167-6296(01)00086-8;,citation_issn=0167-6296;,citation_volume=20;,citation_journal_title=Journal of Health Economics;,citation_journal_abbrev=Journal of Health Economics;">
<meta name="citation_reference" content="citation_title=Estimation methods for models of spatial interaction;,citation_author=J K Ord;,citation_publication_date=1975;,citation_cover_date=1975;,citation_year=1975;,citation_issue=349;,citation_doi=10.1080/01621459.1975.10480272;,citation_volume=70;,citation_journal_title=Journal of the American Statistical Association;">
<meta name="citation_reference" content="citation_title=A primer for working with the Spatial Interaction modeling {}SpInt{} module in the python spatial analysis library {}PySAL{};,citation_author=Taylor M. Oshan;,citation_publication_date=2016-12;,citation_cover_date=2016-12;,citation_year=2016;,citation_fulltext_html_url=http://dx.doi.org/10.18335/region.v3i2.175;,citation_issue=2;,citation_doi=10.18335/region.v3i2.175;,citation_issn=2409-5370;,citation_volume=3;,citation_journal_title=REGION;,citation_publisher=European Regional Science Association;">
<meta name="citation_reference" content="citation_title=The spatial structure debate in spatial interaction modeling: 50 years on;,citation_abstract=Spatial interaction and spatial structure are foundational geographical abstractions, though there is often variation in how they are conceptualized and deployed in quantitative models. In particular, the last five decades have produced an exceptional diversity regarding the role of spatial structure within spatial interaction models. This is explored by outlining the initiation and development of the notion of spatial structure within spatial interaction modeling and critically reviewing four methodological approaches that emerged from ongoing debate about the topic. The outcome is a comprehensive coverage of the past and a sketch of one potential path forward for advancing this long-standing inquiry.;,citation_author=Taylor M. Oshan;,citation_publication_date=2021-10;,citation_cover_date=2021-10;,citation_year=2021;,citation_fulltext_html_url=https://journals.sagepub.com/doi/10.1177/0309132520968134;,citation_issue=5;,citation_doi=10.1177/0309132520968134;,citation_issn=0309-1325, 1477-0288;,citation_volume=45;,citation_language=en-US;,citation_journal_title=Progress in Human Geography;,citation_publisher=SAGE Publications;">
<meta name="citation_reference" content="citation_title=Generalized Additive Spatial Smoothing (GASS): A Multiscale Regression Framework for Modeling Neighborhood Effects Across Spatial Supports;,citation_author=Taylor M. Oshan;,citation_author=Mengyu Liao;,citation_publication_date=2025-01-02;,citation_cover_date=2025-01-02;,citation_year=2025;,citation_fulltext_html_url=https://www.tandfonline.com/doi/full/10.1080/24694452.2024.2401490;,citation_issue=1;,citation_doi=10.1080/24694452.2024.2401490;,citation_issn=2469-4452, 2469-4460;,citation_volume=115;,citation_language=en-US;,citation_journal_title=Annals of the American Association of Geographers;,citation_publisher=Informa UK Limited;">
<meta name="citation_reference" content="citation_title=Modelling spatial choice: A review and synthesis in a migration context;,citation_abstract=This paper reviews various approaches to the modelling of spatial choice. Spatial choice modelling is viewed as a distinct area of research, within the larger field of discrete choice modelling, with a sound methodological basis and computationally tractable modelling framework. This review draws upon empirical application of spatial choice models to interregional migration and identifies the main research issues, summarizes the progress of research thus far, and suggests some paths for future research. It is argued that some of the widely used models suffer from problems derived from their development in aspatial choice contexts. Acknowledging the increased complexity and, possibly, the different choice process that spatial choice situations present over their aspatial counterparts leads to the development of the socalled competing destinations model and its variants. Evidence from empirical tests of these spatial choice models suggests that analysts engaged in interregional migration modelling risk model misspecification if they ignore the peculiarities of spatial choice.;,citation_author=Pasquale A. Pellegrini;,citation_author=A. Stewart Fotheringham;,citation_publication_date=2002-08;,citation_cover_date=2002-08;,citation_year=2002;,citation_fulltext_html_url=https://journals.sagepub.com/doi/10.1191/0309132502ph382ra;,citation_issue=4;,citation_doi=10.1191/0309132502ph382ra;,citation_issn=0309-1325, 1477-0288;,citation_volume=26;,citation_language=en-US;,citation_journal_title=Progress in Human Geography;,citation_publisher=SAGE Publications;">
<meta name="citation_reference" content="citation_title=Effects of Spatial System Design on Spatial Interaction Models. 1: The Spatial System Definition Problem;,citation_abstract=Rather little has been published about systematic empirical research on the problem of spatial aggregation and its effects on spatial interaction models. Of the work which has been published, all of it has dealt almost exclusively with single-parameter spatial interaction models. In this article five different aggregation procedures are examined. The experiments were based on the use of a multivariate multiparametric spatial interaction model. A first set of hypotheses tests was performed with respect to the sensitivity of model parameters to spatial aggregation methods. A second set was performed with respect to the sensitivity of model goodness-of-fit to the five spatial aggregation methods. Although questions remain, the results clearly show that the multiparametric model responds well to different aggregation algorithms. Some parameters showed substantial response, as they should, to different zonal aggregations, whereas others are shown to be much less responsive. Further, the results clearly indicate that systematic aggregation procedures generally produce better results than do random procedures. A future paper will continue with a discussion of zone definition criteria, and recommendations will be made with regard to aggregation algorithms.;,citation_author=S H Putman;,citation_author=S-H Chung;,citation_publication_date=1989-01;,citation_cover_date=1989-01;,citation_year=1989;,citation_fulltext_html_url=http://journals.sagepub.com/doi/10.1068/a210027;,citation_issue=1;,citation_doi=10.1068/a210027;,citation_issn=0308-518X, 1472-3409;,citation_volume=21;,citation_language=en-US;,citation_journal_title=Environment and Planning A: Economy and Space;,citation_journal_abbrev=Environ Plan A;">
<meta name="citation_reference" content="citation_title=The PySAL Ecosystem: Philosophy and Implementation;,citation_abstract=PySAL is a library for geocomputation and spatial data science. Written in Python, the library has a long history of supporting novel scholarship and broadening methodological impacts far afield of academic work. Recently, many new techniques, methods of analyses, and development modes have been implemented, making the library much larger and more encompassing than that previously discussed in the literature. As such, we provide an introduction to the library as it stands now, as well as the scientific and conceptual underpinnings of its core set of components. Finally, we provide a prospective look at the library’s future evolution.;,citation_author=Sergio J. Rey;,citation_author=Luc Anselin;,citation_author=Pedro Amaral;,citation_author=Dani Arribas-Bel;,citation_author=Renan Xavier Cortes;,citation_author=James David Gaboardi;,citation_author=Wei Kang;,citation_author=Elijah Knaap;,citation_author=Ziqi Li;,citation_author=Stefanie Lumnitz;,citation_author=Taylor M. Oshan;,citation_author=Hu Shao;,citation_author=Levi John Wolf;,citation_publication_date=2021-06;,citation_cover_date=2021-06;,citation_year=2021;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/10.1111/gean.12276;,citation_doi=10.1111/gean.12276;,citation_issn=0016-7363;,citation_journal_title=Geographical Analysis;">
<meta name="citation_reference" content="citation_title=On the existence of the maximum likelihood estimates in Poisson regression;,citation_abstract=We note that the existence of the maximum likelihood estimates in Poisson regression depends on the data configuration, and propose a strategy to identify the existence of the problem and to single out the regressors causing it.;,citation_author=J. M. C. Santos Silva;,citation_author=Silvana Tenreyro;,citation_publication_date=2010-05-01;,citation_cover_date=2010-05-01;,citation_year=2010;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0165176510000832;,citation_issue=2;,citation_doi=10.1016/j.econlet.2010.02.020;,citation_issn=0165-1765;,citation_volume=107;,citation_journal_title=Economics Letters;,citation_journal_abbrev=Economics Letters;">
<meta name="citation_reference" content="citation_title=Further simulation evidence on the performance of the Poisson pseudo-maximum likelihood estimator;,citation_abstract=We extend the simulation results in Santos Silva and Tenreyro (2006, The log of gravity, The Review of Economics and Statistics, 88, 641–658) by considering a novel data-generating process. Our results confirm that the Poisson pseudo-maximum likelihood estimator is generally well behaved, even when the proportion of zeros in the sample is very large.;,citation_author=J. M. C. Santos Silva;,citation_author=Silvana Tenreyro;,citation_publication_date=2011-08-01;,citation_cover_date=2011-08-01;,citation_year=2011;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0165176511001741;,citation_issue=2;,citation_doi=10.1016/j.econlet.2011.05.008;,citation_issn=0165-1765;,citation_volume=112;,citation_journal_title=Economics Letters;,citation_journal_abbrev=Economics Letters;">
<meta name="citation_reference" content="citation_title=The Log of Gravity;,citation_abstract=Although economists have long been aware of Jensen’s inequality, many econometric applications have neglected an important implication of it: under heteroskedasticity, the parameters of log-linearized models estimated by OLS lead to biased estimates of the true elasticities. We explain why this problem arises and propose an appropriate estimator. Our criticism of conventional practices and the proposed solution extend to a broad range of applications where log-linearized equations are estimated. We develop the argument using one particular illustration, the gravity equation for trade. We find significant differences between estimates obtained with the proposed estimator and those obtained with the traditional method. Copyright by the President and Fellows of Harvard College and the Massachusetts Institute of Technology.;,citation_author=J. M. C. Santos Silva;,citation_author=Silvana Tenreyro;,citation_publication_date=2006;,citation_cover_date=2006;,citation_year=2006;,citation_fulltext_html_url=https://ideas.repec.org//a/tpr/restat/v88y2006i4p641-658.html;,citation_issue=4;,citation_volume=88;,citation_language=en-US;,citation_journal_title=The Review of Economics and Statistics;,citation_publisher=MIT Press;">
<meta name="citation_reference" content="citation_title=Spatial Econometric OD-Flow Models;,citation_abstract=The Handbook of Regional Science is a multi-volume reference work providing a state-of-the-art knowledge on regional science composed by renowned scientists in the field. The Handbook is intended to serve the academic needs of graduate students, and junior and senior scientists in regional science and related fields, with an interest in studying local and regional socio-economic issues. The multi-volume handbook seeks to cover the field of regional science comprehensively, including areas such as regional housing and labor markets, regional economic growth, innovation and regional economic development, new and evolutionary economic geography, location and interaction, the environment and natural resources, spatial analysis and geo-computation as well as spatial statistics and econometrics.;,citation_author=Christine Thomas-Agnan;,citation_author=James P. LeSage;,citation_editor=Manfred M. Fischer;,citation_editor=Peter Nijkamp;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_fulltext_html_url=http://link.springer.com/10.1007/978-3-642-23430-9;,citation_doi=10.1007/978-3-642-23430-9_87;,citation_isbn=978-3-642-23429-3;,citation_inbook_title=Handbook of Regional Science;">
<meta name="citation_reference" content="citation_title=An alternative formulation for spatial-interaction modeling;,citation_author=W Tobler;,citation_publication_date=1983;,citation_cover_date=1983;,citation_year=1983;,citation_issue=5;,citation_volume=15;,citation_journal_title=Environment and Planning A;">
<meta name="citation_reference" content="citation_title=A statistical theory of spatial distribution models;,citation_author=A. G. Wilson;,citation_publication_date=1967-11-01;,citation_cover_date=1967-11-01;,citation_year=1967;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/0041164767900354;,citation_issue=3;,citation_doi=10.1016/0041-1647(67)90035-4;,citation_issn=0041-1647;,citation_volume=1;,citation_journal_title=Transportation Research;,citation_journal_abbrev=Transportation Research;">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Install and Run</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Spatial: Networks, Interaction, &amp; Econometrics for Migration</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/knaaptime/workshop-nersa25/tree/main/docs/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Install and Run</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebooks/01_spatial_graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Spatial <code>Graph</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebooks/02_spatial_interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Migration Graphs and Spatial Interaction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebooks/03_spatial_dependence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Spatial Interaction with Spatial Dependence</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#install-and-run" id="toc-install-and-run" class="nav-link active" data-scroll-target="#install-and-run"><span class="header-section-number">1</span> Install and Run</a></li>
  <li><a href="#schedule" id="toc-schedule" class="nav-link" data-scroll-target="#schedule"><span class="header-section-number">2</span> Schedule</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><span class="header-section-number">2.1</span> Overview</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">2.2</span> Introduction</a></li>
  <li><a href="#spatial-data-in-python" id="toc-spatial-data-in-python" class="nav-link" data-scroll-target="#spatial-data-in-python"><span class="header-section-number">2.3</span> spatial data in python</a></li>
  <li><a href="#spatial-graphs" id="toc-spatial-graphs" class="nav-link" data-scroll-target="#spatial-graphs"><span class="header-section-number">2.4</span> spatial graphs</a></li>
  <li><a href="#spatial-interaction-models" id="toc-spatial-interaction-models" class="nav-link" data-scroll-target="#spatial-interaction-models"><span class="header-section-number">2.5</span> spatial interaction models</a></li>
  <li><a href="#spatial-econometric-models" id="toc-spatial-econometric-models" class="nav-link" data-scroll-target="#spatial-econometric-models"><span class="header-section-number">2.6</span> spatial econometric models</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/knaaptime/workshop-nersa25/edit/main/docs/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/knaaptime/workshop-nersa25/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/knaaptime/workshop-nersa25/blob/main/docs/index.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div><div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="https://codespaces.new/knaaptime/workshop-nersa25"><i class="bi bi-cloud"></i>Open in Codespaces</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Spatial: Networks, Interaction, &amp; Econometrics for Migration</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://knaaptime.com">Elijah Knaap, Ph.D</a> <a href="mailto:eknaap@uci.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-7520-2238" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of California, Irvine
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 25, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>NERSA/NARSC Program in Mobility, Migration &amp; Regional Science</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/commutes.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="D.C. Commutes"><img src="img/commutes.png" class="img-fluid figure-img" alt="D.C. Commutes"></a></p>
<figcaption>D.C. Commutes</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/codespaces/badge.svg" class="img-fluid figure-img"></p>
<figcaption>Open in GitHub Codespaces</figcaption>
</figure>
</div>
<section id="install-and-run" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Install and Run</h1>
<p>To run locally:</p>
<ul>
<li>install <a href="https://pixi.sh/dev/installation/">pixi</a></li>
<li>clone this repository, follow below</li>
</ul>
<p>To run in codespaces:</p>
<ul>
<li>click the ‘open in codespaces’ button above
<ul>
<li>the default config will include at least 8 cores (dont go below 32gb memory), but you can crank it up for better performance</li>
</ul></li>
<li><code>pixi install</code></li>
<li><code>pixi run jupyter lab</code></li>
</ul>
<p>if running in a codespace this starts a jupyter server on the VM’s ‘localhost’. Open an existing notebook (or start a new one). When selecting a kernel, choose ‘Existing jupyter server’ and copy/paste the URL with token from the terminal</p>
<p>edit the notebooks as you like</p>
<p><strong>if you want to use the jupyterlab interface instead of VSCode</strong>:</p>
<ul>
<li>in the bottom panel click the “ports” tab</li>
<li>click the “add port” button
<ul>
<li>type 8888</li>
<li><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/ports.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="ports"><img src="img/ports.png" class="img-fluid figure-img" alt="ports"></a></p>
<figcaption>ports</figcaption>
</figure>
</div></li>
</ul></li>
<li>click back in the vscode interface
<ul>
<li>click the “terminal” tab in the bottom panel</li>
<li>scroll up and copy the <em>token</em> string from the URL</li>
<li><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/token.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="token"><img src="img/token.png" class="img-fluid figure-img" alt="token"></a></p>
<figcaption>token</figcaption>
</figure>
</div></li>
<li>click back into jupyterlab and paste the token</li>
</ul></li>
</ul>
</section>
<section id="schedule" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Schedule</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/flow_nbs.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Flow Neighbor Example"><img src="img/flow_nbs.png" class="img-fluid figure-img" alt="Flow Neighbor Example"></a></p>
<figcaption>Flow Neighbor Example</figcaption>
</figure>
</div>
<section id="overview" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">2.1</span> Overview</h2>
<ul>
<li>spatial data and analysis in python</li>
<li>encoding spatial relationships</li>
<li>model flows via spatial interaction</li>
<li>model flows via spatial econometric interaction</li>
</ul>
</section>
<section id="introduction" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="introduction"><span class="header-section-number">2.2</span> Introduction</h2>
<p>open source and open science</p>
<ul>
<li>pixi &amp; conda</li>
<li>jupyter</li>
<li>python</li>
<li>python</li>
<li>pysal</li>
<li>geosnap</li>
</ul>
</section>
<section id="spatial-data-in-python" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="spatial-data-in-python"><span class="header-section-number">2.3</span> spatial data in python</h2>
<ul>
<li>pandas</li>
<li>numpy</li>
<li>shapely</li>
<li>geopandas</li>
<li>census and lodes</li>
</ul>
</section>
<section id="spatial-graphs" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="spatial-graphs"><span class="header-section-number">2.4</span> spatial graphs</h2>
<p>encoding relationships between spatial objects</p>
<ul>
<li>contiguity</li>
<li>k-nearest neighbors</li>
<li>distance</li>
<li>flows</li>
</ul>
</section>
<section id="spatial-interaction-models" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="spatial-interaction-models"><span class="header-section-number">2.5</span> spatial interaction models</h2>
<p>modeling the flow between <span class="math inline">\(o\)</span> and <span class="math inline">\(d\)</span> as a function of push and pull factors</p>
<ul>
<li>gravity model (unconstrained)</li>
<li>attraction constrained</li>
<li>production constrained</li>
<li>doubly constrained</li>
</ul>
</section>
<section id="spatial-econometric-models" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="spatial-econometric-models"><span class="header-section-number">2.6</span> spatial econometric models</h2>
<p>multiple graphs: modeling spatial dependence in the flow between <span class="math inline">\(o\)</span> and <span class="math inline">\(d\)</span> via <span class="math inline">\(^oW\)</span>, <span class="math inline">\(^dW\)</span>, and <span class="math inline">\(^{od}W\)</span></p>
<ul>
<li>spatial dependence</li>
<li>OD-Graphs</li>
<li>lag models</li>
<li>error models</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./notebooks/01_spatial_graphs.html" class="pagination-link" aria-label="The Spatial `Graph`">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Spatial <code>Graph</code></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/knaaptime/workshop-nersa25/edit/main/docs/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/knaaptime/workshop-nersa25/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/knaaptime/workshop-nersa25/blob/main/docs/index.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>